import r from"isomorphic-unfetch";import{createClient as e}from"@supabase/supabase-js";function t(){return t=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},t.apply(this,arguments)}function o(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,n(r,e)}function n(r,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,e){return r.__proto__=e,r},n(r,e)}var a,s=function(){function o(r){this.version=void 0,this.basePath=void 0,this.defaultVersion="v1/",this.defaultBaseURL="https://api.spotbase.io/",this.authToken=void 0,this.supabase=void 0,this.version=r&&r.version&&r.version+"/"||this.defaultVersion,this.basePath=r&&r.basePath&&r.basePath+"/"+this.version||this.defaultBaseURL+this.version,this.supabase=e("https://yijpzmbtxcpgpswkvyfd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpanB6bWJ0eGNwZ3Bzd2t2eWZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTQwOTAyNTgsImV4cCI6MjAwOTY2NjI1OH0.I66q9wcZlkYXTMN1RKB_hLorD71jWq2ehaNxjA31Imk")}var n=o.prototype;return n.request=function(e,o,n){var a=this.basePath+e,s={"Content-type":"application/json"};o&&(s=t({},s,{Authorization:"Bearer "+this.getAuthToken()}));var i=t({},n,{headers:s});return r(a,i).then(function(r){if(r.ok)return r.json();throw new Error(r.statusText)})},n.setAuthToken=function(r){r&&(this.authToken=r)},n.getAuthToken=function(){return this.authToken},o}(),i="project/PROJECT/addon/cms/TOKEN/",u=function(r){function e(){return r.apply(this,arguments)||this}o(e,r);var t=e.prototype;return t.getCMSConfig=function(r,e){try{if(!e||!r)return Promise.resolve({data:{},error:new Error("project and token are required")});var t=i.replace("PROJECT",r).replace("TOKEN",e);return Promise.resolve(this.request(t+"config")).then(function(r){return r?{data:r,error:null}:{data:{},error:new Error("error getting cms config")}})}catch(r){return Promise.reject(r)}},t.patchCMSConfig=function(r,e,t){try{if(!e||!r||!t)return Promise.resolve({data:"error",error:new Error("project, token and config are required")});var o=i.replace("PROJECT",r).replace("TOKEN",e);return Promise.resolve(this.request(o+"config",!0,{method:"PATCH",body:JSON.stringify(t)})).then(function(r){var e=r.data,t=r.error;return t?{data:"error",error:new Error(t.message)}:{data:e,error:null}})}catch(r){return Promise.reject(r)}},t.getItems=function(r,e){try{if(!e||!r)return Promise.resolve({data:"error",error:new Error("project and token are required")});var t=i.replace("PROJECT",r).replace("TOKEN",e);return Promise.resolve(this.request(t+"items")).then(function(r){var e=r.data,t=r.error;return t?{data:"error",error:new Error(t.message)}:{data:e,error:null}})}catch(r){return Promise.reject(r)}},t.getFields=function(r,e){try{if(!e||!r)return Promise.resolve({data:"error",error:new Error("project and token are required")});var t=i.replace("PROJECT",r).replace("TOKEN",e);return Promise.resolve(this.request(t+"fields",!0)).then(function(r){var e=r.data,t=r.error;return t?{data:"error",error:new Error(t.message)}:{data:e,error:null}})}catch(r){return Promise.reject(r)}},t.getProgress=function(r,e){try{if(!e||!r)return Promise.resolve({data:"error",error:new Error("project and token are required")});var t=i.replace("PROJECT",r).replace("TOKEN",e);return Promise.resolve(this.request(t+"progress",!0)).then(function(r){var e=r.data,t=r.error;return t?{data:"error",error:new Error(t.message)}:{data:e,error:null}})}catch(r){return Promise.reject(r)}},t.getAddon=function(r){try{return r?Promise.resolve(this.supabase.from("addons").select().eq("id",r).maybeSingle()).then(function(r){var e=r.data,t=r.error;return t?{data:null,error:new Error(t.message)}:{data:{id:e.id,name:e.name,project:e.project,type:e.type,user_id:e.user_id,data:e.data},error:null}}):Promise.resolve({data:null,error:new Error("addon id is required")})}catch(r){return Promise.reject(r)}},t.getAddons=function(r,e,t){try{return Promise.resolve(this.supabase.from("addons").select("id,created_at,name,project,type,data,user_id").order("created_at",{ascending:!1}).range(e,t).eq("project",r)).then(function(r){var e=r.data,t=r.error;if(t)return{data:[],error:new Error(t.message)};var o=[];return e.forEach(function(r){o.push({id:r.id,name:r.name,project:r.project,type:r.type,user_id:r.user_id,data:r.data})}),{data:o,error:null}})}catch(r){return Promise.reject(r)}},e}(s),c=function(r){function e(){return r.apply(this,arguments)||this}o(e,r);var t=e.prototype;return t.login=function(r,e){try{var t=this;return Promise.resolve(t.supabase.auth.signInWithPassword({email:r,password:e})).then(function(r){var e=r.data;return e.session?(t.setAuthToken(e.session.access_token),{data:!0,error:null}):{data:!1,error:new Error("login error")}})}catch(r){return Promise.reject(r)}},t.logout=function(){try{return Promise.resolve(this.supabase.auth.signOut()).then(function(r){var e=r.error;200!=e.status&&console.log(e.message)})}catch(r){return Promise.reject(r)}},t.isLogged=function(){try{var r=this;return Promise.resolve(r.supabase.auth.getSession()).then(function(e){var t=e.data;return t.session?(r.setAuthToken(t.session.access_token),{data:!0,error:null}):{data:!1,error:new Error("is logged error")}})}catch(r){return Promise.reject(r)}},e}(s),d="project/PROJECT/",p=function(r){function e(){return r.apply(this,arguments)||this}o(e,r);var t=e.prototype;return t.getProjectDomains=function(r){try{if(!r)return Promise.resolve({data:[],error:new Error("project id is required")});var e=d.replace("PROJECT",r);return Promise.resolve(this.request(e+"domains",!0)).then(function(r){var e=r.data,t=r.error;if(t)return{data:[],error:new Error(t.message)};var o=[];return e.forEach(function(r){o.push({id:r.id,name:r.name,value:r.value})}),{data:o,error:null}})}catch(r){return Promise.reject(r)}},t.patchProjectDomains=function(r,e){try{if(!r||!e)return Promise.resolve({data:"error",error:new Error("project id and domains data are required")});var t=d.replace("PROJECT",r);return Promise.resolve(this.request(t+"domains",!0,{method:"PATCH",body:JSON.stringify(e)})).then(function(r){var e=r.error;return e?{data:"error",error:new Error(e.message)}:{data:"ok",error:null}})}catch(r){return Promise.reject(r)}},t.deleteProjectDomains=function(r,e){try{if(!r||!e)return Promise.resolve({data:"error",error:new Error("project id and domains data are required")});var t=d.replace("PROJECT",r);return Promise.resolve(this.request(t+"domains",!0,{method:"DELETE",body:JSON.stringify(e)})).then(function(r){var e=r.error;return e?{data:"error",error:new Error(e.message)}:{data:"ok",error:null}})}catch(r){return Promise.reject(r)}},t.getProjects=function(r,e){try{return Promise.resolve(this.supabase.from("projects").select("id,name,description,emoji,domains").order("created_at",{ascending:!1}).range(r,e)).then(function(r){var e=r.data,t=r.error;if(t)return{data:[],error:new Error(t.message)};var o=[];return e.forEach(function(r){var e={id:r.id,description:r.description,emoji:r.emoji,name:r.name,domains:[]};r.domains.forEach(function(r){e.domains.push({id:r.id,name:r.name,value:r.value})}),o.push(e)}),{data:o,error:null}})}catch(r){return Promise.reject(r)}},t.getProject=function(r){try{return r?Promise.resolve(this.supabase.from("projects").select().eq("id",r).maybeSingle()).then(function(r){var e=r.data,t=r.error;if(t)return{data:null,error:new Error(t.message)};var o={id:e.id,description:e.description,emoji:e.emoji,name:e.name,domains:[]};return e.domains.forEach(function(r){o.domains.push({id:r.id,name:r.name,value:r.value})}),{data:o,error:null}}):Promise.resolve({data:null,error:new Error("project id is required")})}catch(r){return Promise.reject(r)}},e}(s),h=function(r){function e(){return r.apply(this,arguments)||this}return o(e,r),e}(s);a=h,[u,c,p].forEach(function(r){Object.getOwnPropertyNames(r.prototype).forEach(function(e){Object.defineProperty(a.prototype,e,Object.getOwnPropertyDescriptor(r.prototype,e))})});export{h as default};
//# sourceMappingURL=index.m.js.map
